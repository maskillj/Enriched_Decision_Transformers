/Users/jamesmaskill/miniforge3/envs/py10env/lib/python3.10/site-packages/gym/spaces/box.py:84: UserWarning: [33mWARN: Box bound precision lowered by casting to float32
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")

load datafile: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 11/11 [00:01<00:00,  6.61it/s]
[1m[2024-09-15 19:31:07][22m	Episode 2:
{'reward': np.float64(275.780305658775), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 19:36:25][22m	Episode 4:
{'reward': np.float64(303.13329832321404), 'max_drawdown': np.float64(-2.7311009045471977)}
[1m[2024-09-15 19:41:44][22m	Episode 6:
{'reward': np.float64(302.84084715662107), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 19:46:58][22m	Episode 8:
{'reward': np.float64(281.8473514951694), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 19:52:14][22m	Episode 10:
{'reward': np.float64(300.6413671552196), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 19:57:32][22m	Episode 12:
{'reward': np.float64(307.8533447778731), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:03:05][22m	Episode 14:
{'reward': np.float64(312.2206572691423), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:09:21][22m	Episode 16:
{'reward': np.float64(307.2269319383062), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:14:43][22m	Episode 18:
{'reward': np.float64(281.3116368291861), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:19:20][22m	Episode 20:
{'reward': np.float64(308.6552416272106), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:22:26][22m	Episode 22:
{'reward': np.float64(273.97527520913127), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:25:46][22m	Episode 24:
{'reward': np.float64(286.08945369222374), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:28:52][22m	Episode 26:
{'reward': np.float64(290.52444092589695), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:31:56][22m	Episode 28:
{'reward': np.float64(277.2225037766638), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:34:45][22m	Episode 30:
{'reward': np.float64(305.94176595780493), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:37:35][22m	Episode 32:
{'reward': np.float64(301.40910274715645), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:40:20][22m	Episode 34:
{'reward': np.float64(280.51470090417547), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:43:06][22m	Episode 36:
{'reward': np.float64(282.3543041308586), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:45:50][22m	Episode 38:
{'reward': np.float64(278.5895519617223), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:48:36][22m	Episode 40:
{'reward': np.float64(292.9764076989031), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:51:19][22m	Episode 42:
{'reward': np.float64(305.92280982301247), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:54:06][22m	Episode 44:
{'reward': np.float64(284.7846172490225), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:56:52][22m	Episode 46:
{'reward': np.float64(289.17536280956057), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 20:59:55][22m	Episode 48:
{'reward': np.float64(297.2613433320901), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:02:50][22m	Episode 50:
{'reward': np.float64(285.2781974983121), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:05:42][22m	Episode 52:
{'reward': np.float64(293.7645532338894), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:08:36][22m	Episode 54:
{'reward': np.float64(312.89770889653494), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:11:28][22m	Episode 56:
{'reward': np.float64(321.75737786855916), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:14:18][22m	Episode 58:
{'reward': np.float64(307.3946864580378), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:17:14][22m	Episode 60:
{'reward': np.float64(297.65176510274466), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:20:10][22m	Episode 62:
{'reward': np.float64(295.440542076606), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:23:06][22m	Episode 64:
{'reward': np.float64(319.4865097372036), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:26:05][22m	Episode 66:
{'reward': np.float64(284.0517607541946), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:29:00][22m	Episode 68:
{'reward': np.float64(294.62669802644126), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:31:54][22m	Episode 70:
{'reward': np.float64(272.0550531676759), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:34:51][22m	Episode 72:
{'reward': np.float64(267.2978022304723), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:37:46][22m	Episode 74:
{'reward': np.float64(262.87282343780623), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:40:44][22m	Episode 76:
{'reward': np.float64(294.32125160014084), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:43:42][22m	Episode 78:
{'reward': np.float64(268.7918714047806), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:46:30][22m	Episode 80:
{'reward': np.float64(277.04273603675904), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:49:20][22m	Episode 82:
{'reward': np.float64(295.25916655667396), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:52:10][22m	Episode 84:
{'reward': np.float64(294.78811745631697), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:55:05][22m	Episode 86:
{'reward': np.float64(271.9590673668696), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 21:57:59][22m	Episode 88:
{'reward': np.float64(293.02183060535504), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:00:52][22m	Episode 90:
{'reward': np.float64(300.98449793448685), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:03:46][22m	Episode 92:
{'reward': np.float64(278.6878395762186), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:06:37][22m	Episode 94:
{'reward': np.float64(284.67431468572624), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:09:30][22m	Episode 96:
{'reward': np.float64(283.332768574043), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:12:26][22m	Episode 98:
{'reward': np.float64(283.8471948871211), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:15:24][22m	Episode 100:
{'reward': np.float64(296.91145126449817), 'max_drawdown': np.float64(-2.79979303315251)}
[1m[2024-09-15 22:18:16][22m	Episode 102:
{'reward': np.float64(301.9222360312246), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:20:57][22m	Episode 104:
{'reward': np.float64(270.4739666270878), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:23:38][22m	Episode 106:
{'reward': np.float64(282.83039473913254), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:26:20][22m	Episode 108:
{'reward': np.float64(277.86277788878243), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:29:05][22m	Episode 110:
{'reward': np.float64(302.66518542139437), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:31:47][22m	Episode 112:
{'reward': np.float64(307.9684896082005), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:34:31][22m	Episode 114:
{'reward': np.float64(284.4866933977538), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:39:06][22m	Episode 116:
{'reward': np.float64(302.3880110095905), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:45:04][22m	Episode 118:
{'reward': np.float64(314.6765572693281), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:50:52][22m	Episode 120:
{'reward': np.float64(279.6323042837209), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 22:56:20][22m	Episode 122:
{'reward': np.float64(278.5979644529558), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 23:02:05][22m	Episode 124:
{'reward': np.float64(316.0976007742812), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 23:07:57][22m	Episode 126:
{'reward': np.float64(268.92993115165575), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 23:13:27][22m	Episode 128:
{'reward': np.float64(277.33006255667317), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 23:18:42][22m	Episode 130:
{'reward': np.float64(272.54588920507376), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-15 23:24:00][22m	Episode 132:
{'reward': np.float64(288.38427415350003), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 11:46:30][22m	Episode 134:
{'reward': np.float64(281.99552888543946), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 11:49:28][22m	Episode 136:
{'reward': np.float64(312.38145553309414), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 11:52:30][22m	Episode 138:
{'reward': np.float64(293.4986675789858), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 11:55:56][22m	Episode 140:
{'reward': np.float64(283.92906513909554), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 11:59:21][22m	Episode 142:
{'reward': np.float64(272.32267750407755), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:02:48][22m	Episode 144:
{'reward': np.float64(303.1585472635712), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:06:11][22m	Episode 146:
{'reward': np.float64(279.19680391074974), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:09:40][22m	Episode 148:
{'reward': np.float64(301.4064144182813), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:13:07][22m	Episode 150:
{'reward': np.float64(298.21357684483), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:16:38][22m	Episode 152:
{'reward': np.float64(298.14289105585266), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:20:12][22m	Episode 154:
{'reward': np.float64(287.77386851648174), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:23:47][22m	Episode 156:
{'reward': np.float64(297.3618584849352), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:26:39][22m	Episode 158:
{'reward': np.float64(298.7166154891806), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:29:27][22m	Episode 160:
{'reward': np.float64(268.04714563400034), 'max_drawdown': np.float64(0.0)}
[1m[2024-09-16 12:33:08][22m	Episode 162:
{'reward': np.float64(299.13920950467207), 'max_drawdown': np.float64(0.0)}
Traceback (most recent call last):
  File "/Users/jamesmaskill/Documents/GitHub/Enriched_Decision_Transformers/scripts/test_drawdown.py", line 71, in <module>
    train_metrics = policy.update(batch, clip_grad=args.clip_grad)
  File "/Users/jamesmaskill/Desktop/Decision_Transformers/VS_Implementation/src/drawdown_control/decision_transformer_policy.py", line 93, in update
    actor_loss.backward()
  File "/Users/jamesmaskill/miniforge3/envs/py10env/lib/python3.10/site-packages/torch/_tensor.py", line 525, in backward
    torch.autograd.backward(
  File "/Users/jamesmaskill/miniforge3/envs/py10env/lib/python3.10/site-packages/torch/autograd/__init__.py", line 267, in backward
    _engine_run_backward(
  File "/Users/jamesmaskill/miniforge3/envs/py10env/lib/python3.10/site-packages/torch/autograd/graph.py", line 744, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt